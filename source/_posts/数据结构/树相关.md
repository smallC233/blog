---
title: 树相关
categories:
  - 竞赛相关
  - 数据结构
  - 树
---
## 对于树相关问题的复杂度分析

由于树本身具有特别强的约束，所以往往看起来很高的复杂度实际上可以被证明要比直观上低几个量级（例如经典的吉司机线段树的复杂度分析），如果不能看出正确的复杂度就会错失一个正确的思路。

对于树上复杂度的分析，经常会用到的一个式子为: $\sum{a_i^2} ≤ (\sum{a_i})^2 = n^2$ （平方的和≤和的平方）



##### 例题：[树形地铁系统](https://www.acwing.com/problem/content/description/159/)

题意：对于两棵已知根的有根树，判断两棵树是否同构，节点数 $n\leqslant1500$。

一种比较直观的想法从下往上分析每一层，对于每一层的所有节点，$n_{father}^2$ 两两比较是否相同，相同则记录相同关系。判断两个节点是否相同的方法是分析它们的儿子是否存在完美匹配，直接 $n_{son}^2$ 暴力匹配即可（匹配不论顺序，相同则拿走当前一对，找不到相同就是不匹配）。这样操作看似时间复杂度来到了恐怖的 $n^4$，但仔细一分析就发现 $\sum{n_{father}^2n_{son}^2}≤ (\sum{n_{father+1(层数+1)}})^2 \leqslant n^2$，因此是正确的复杂度。





## 判断树同构

#### 例题：[树形地铁系统](https://www.acwing.com/problem/content/description/159/)（就是上题）

判断树同构有**树的最小表示法**和**树哈希**两种方法。



##### 树的最小表示法（有板子）：

时间复杂度：最坏 O(n^2) （一条链的情况）。

用一串 01 串表示树的结构，0 是向下一层，1 是向上一层，从下往上对每个节点的儿子的最小表示法 sort 即可得到该节点的最小表示法。



##### 树哈希（有板子）：

时间复杂度：O(n)

###### 有根树哈希：

一个节点下的多个儿子的哈希值可以看出一个集合，采用对集合的哈希即可得到此节点的哈希值。

###### 无根树的哈希：

一棵树最多只有两个重心，以重心为根做有根树哈希，取较小的哈希值作为无根树的哈希值即可。 
