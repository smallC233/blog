---
title: 第三章 数据链路层
---
# 第三章 数据链路层

## 概述

**链路**（Link）就是从一个结点到相邻结点的一段物理线路，而中间没有任何其他的交换结点。
**数据链路**（Data Link）是指把实现通信协议的硬件和软件加到链路上，就构成了数据链路。
数据链路层以**帧**为单位传输和处理数据。

![3_1](C:\Users\25394\Desktop\md\计算机网络\picture\3_1.png)



### 使用点对点信道的数据链路层

点对点信道的数据链路层通信需要解决**三个重要问题**：

* 封装成帧：将数据按一定格式组织成帧，以便在网络中进行传输，每帧包含控制信息和数据部分。

![3_2](C:\Users\25394\Desktop\md\计算机网络\picture\3_2.png)

* 差错检测：通过附加冗余信息来检测传输过程中可能发生的错误，从而保证数据的完整性。

![3_3](C:\Users\25394\Desktop\md\计算机网络\picture\3_3.png)

* 可靠传输：尽管误码是不能完全避免的，但若能实现发送方发送什么接收方就能收到什么，就称为可靠传输。具体则是通过确认应答、重传机制等手段确保数据在不可靠的网络环境中能够正确、完整地传送，会在下文介绍。



### 使用广播信道的数据链路层

上述三个重要问题针对点对点信道的数据链路层通信，那如果不是点对点而是使用广播信道的数据链路层，如何知道所收到的帧是不是发送给它们的？

答案是通过帧头中的信息判断。

![3_4](C:\Users\25394\Desktop\md\计算机网络\picture\3_4.png)

那链路上的碰撞如何避免呢？

答案是通过`共享式以太网的媒体接入控制协议 CSMA/CD 协议`，`802.11 局域网的媒体接入控制协议 CSMA/CA` 等协议控制，会在之后介绍。

![3_5](C:\Users\25394\Desktop\md\计算机网络\picture\3_5.png)

![3_6](C:\Users\25394\Desktop\md\计算机网络\picture\3_6.png)



### 数据链路层的互连设备

随着技术的发展，交换技术的成熟和成本的降低，具有更高性能的使用点对点链路和链路层交换机的交换式局域网在有线（局域网）领域已完全取代了共享式局域网。不过，由于无线信道的广播天性，无线局域网仍然使用的是共享信道技术。

对于这些互连设备，像是网桥和交换机的工作原理，集线器（物理层互连设备）与交换机的区别等内容会在下文逐个进行介绍。



## 封装成帧

**封装成帧**是指数据链路层给上层交付的协议数据单元添加帧头和帧尾使之成为帧。帧头和帧尾中包含有重要的控制信息。

![3_7](C:\Users\25394\Desktop\md\计算机网络\picture\3_7.png)



### 帧定界

那接收方的数据链路层如何从物理层交付的比特流中提取出一个个的帧？

![3_8](C:\Users\25394\Desktop\md\计算机网络\picture\3_8.png)

可以通过帧头和帧尾。

帧头和帧尾的作用之一就是**帧定界**。

通过在头和尾加入一个标志字符，让接收端以此来判断一个帧什么时候开始和结束。

![3_9](C:\Users\25394\Desktop\md\计算机网络\picture\3_9.png)

但似乎这样会导致中间的数据中不能出现这个标志字符了，这样就不能满足透明传输的要求。



### 透明传输

**透明传输**是指**数据链路层对上层交付的传输数据没有任何限制**，就好像数据链路层不存在一样，自然不会对其中出现的内容加以限制。

那如何解决此问题？答案是使用转移字符，和 C++ 字符串中的转移字符一样，把数据中的标志字符和转义字符全部转义掉，这样它们就不会被误判了。

如 C++ 中的字符串 `he said "Oh Mary\contrary\\how does your garden grow?".` 需要加入转义字符变成 `"he said \"Oh Mary\\contrary\\\\how does your garden grow?\"."`

在这里，一段数据：

![3_12](C:\Users\25394\Desktop\md\计算机网络\picture\3_12.png)

需要加入转移字符变成：

![3_13](C:\Users\25394\Desktop\md\计算机网络\picture\3_13.png)

需要说明的是，转义字待是一种特殊的控制字符，其长度为1个字节，ascii 码为27，而并不是 E、S、C 这 3 个字符🤣。



在**面向字节**的物理链路使用**字节填充**（或称字符填充）的方法实现透明传输。

而在**面向比特**的物理链路中使用**比特填充**的方法实现透明传输。

帧的首部和尾部都是 `01111110`（六个 1），因此发送端对数据部分，每连续五个 1 后面就插入一个 0，这样首位标志就是唯一的了。接收段再每连续五个 1 后面去掉一个 0，这样数据就还原了。

例子：

* 数据：**01111110**0111110100011111111**01111110** 
* 发送端加 0 ：**01111110**011111**0**0100011111**0**111**01111110** 
* 接收段去 0 ：**01111110**011111~~0~~0100011111~~0~~111**01111110** 

![3_14](C:\Users\25394\Desktop\md\计算机网络\picture\3_14.png)



此外，需要说明的是，并不是每一种数据链路层协议的帧都包含有帧定界标志。例如以太网 V2 的 MAC 帧中就不存在用于定界的部分，因为它把定界的任务丢给了物理层的前导码。

![3_10](C:\Users\25394\Desktop\md\计算机网络\picture\3_10.png)

另外，以太网还规定了帧间间隔时间为 96 比特的发送时间，因此，MAC 帧并不需要帧结束定界符。

![3_11](C:\Users\25394\Desktop\md\计算机网络\picture\3_11.png)



### 长度要求

* 为了提高帧的传输效率，应当使**帧的数据部分的长度尽可能大些**。
* 但同时，考虑到差错控制等多种因素，每一种数据链路层协议都规定了帧的数据部分的长度上限，即最大传送单元 MTU (Maximum Transfer Unit)。

![3_15](C:\Users\25394\Desktop\md\计算机网络\picture\3_15.png)



## 差错检测

* 实际的通信链路都不是理想的，比特在传输过程中可能会产生差错：1 可能会变成 0 而 0 也可能变成 1。这称为**比特差错**。
* 在一段时间内，传输错误的比特占所传输比特总数的比率称为**误码率 BER** (BitError Rate)。
* 使用**差错检测码**来检测数据在传输过程中是否产生了比特差错，是数据链路层所要解决的重要问题之一。
* **检错码**只能检测出帧在传输过程中出现了差错，但并不能定位错误，因此**无法纠正错误**。
* 要想纠正传输中的差错，可以使用冗余信息更多的**纠错码**进行**前向纠错**。但纠错码的开销比较大，**在计算机网络中较少使用**。
* 循环冗余校验 **CRC** 有很好的检错能力（**漏检率非常低**），虽然计算比较复杂，但非常**易于用硬件实现**，因此被**广泛应用于数据链路层**。
* 在计算机网络中通常采用我们后续课程中将要讨论的**检错重传方式来纠正传输中的差错或者仅仅是丢弃检测到差错的帧**，这取决于数据链路层向其上层提供的是可靠传输服务还是不可靠传输服务。

奇偶校验和 CRC 详见机组[校验码](../计算机组成原理/数据的表示和运算.md#校验码)。



## 可靠传输

使用**差错检测技术**（例如循环冗余校验 CRC），接收方的数据链路层就可检测出帧在
传输过程中是否产生了**误码**（比特错误）。

数据链路层向上层提供的服务类型：

* **不可靠传输服务**：**仅仅丢弃有误码的帧**，其他什么也不做;
* **可靠传输服务**：想办法实现**发送端发送什么**，**接收端就收到什么**。



一般情况下，**有线链路**的误码率比较低，为了减小开销，**并不要求数据链路层**向上提供
**可靠**传输服务。即使出现了误码，可靠传输的问题由其上层处理。

**无线链路**易受干扰，误码率比较高，因此**要求数据链路层**必须向上层提供**可靠**传输服务。

![3_16](C:\Users\25394\Desktop\md\计算机网络\picture\3_16.png)



**比特差错**只是传输差错中的一种。

从整个计算机网络体系结构来看，传输差错还包括**分组丢失**、**分组失序**以及**分组重复**。

分组丢失、分组失序以及分组重复这些传输差错，一般不会出现在数据链路层，而会
出现在其上层。因此，**可靠传输服务并不仅局限于数据链路层**，其他各层均可选择实现可靠传输。

![3_17](C:\Users\25394\Desktop\md\计算机网络\picture\3_17.png)

可靠传输的实现比较复杂，开销也比较大，是否使用可靠传输取决于应用需求。



可靠传输的**实现机制**有下列三种：

* 停止-等待协议 SW
* 回退 N 帧协议 GBN
* 选择重传协议 SR

这三种可靠传输实现机制的基本原理并不仅限于数据链路层可以应用到计算机网络体系结构的各层协议中。希望大家在学习时，不要把思维局限在数据链路层，而应放眼于整个网络体系结构。



### 停止-等待协议 SW

Stop-and-Wait Protocol.

停止等待协议通常用于较为简单的应用场景，适合数据量较小且网络延迟相对较低的情况。在大多数高效的通信协议中，停止等待协议的概念会被扩展成更复杂的流控机制。



#### 协议流程

1. **发送方**：发送方将数据包发送给接收方，然后等待接收方发送确认（ACK）。
2. **接收方**：接收方在接收到数据包后，会检查数据包是否正确，如果正确，发送一个**确认消息（ACK）**回发送方，否则发送**否定确认消息（NAK）**。
3. **超时重传**：如果发送方接收到了 NAK，或者在指定时间内没有收到 ACK，它会重传相同的数据包。



**主要特点**：

发送方每次只发送**一个**数据包，并等待接收方确认收到这个数据包后才会发送下一个数据包。因此，发送方每发送完一个数据包后，并不能立刻将该数据包从缓存中删除，只有在收到针对该数据包的确认包后，才能将其从缓存中删除。



#### 差错情况与解决

**发送消息出现误码**

接收方检测到数据分组有误码时，将其丢弃并等待发送方的超时重传。但对于误码率较高的点对点链路，为使发送方**尽早重传**，也可**给发送方发送 NAK 分组**。

![3_18](C:\Users\25394\Desktop\md\计算机网络\picture\3_18.png)



**发送消息丢失**

接收方收不到数据分组，就不会发送 ACK 或 NAK。如果不采取其他措施，发送方就会一直处于等待接收方 ACK 或 NAK 的状态。

为解决该问题，可以在发送方发送完一个数据分组时，启动一个超时计时器。若到了超时计时器所设置的重传时间而发送方仍收不到接收方的任何 ACK 或 NAK，则重传原来的数据分组，这就叫做**超时重传**。

超时计时器设置的**重传时间**应仔细选择。一般可将重传时间选为**略大于“从发送方到接收方的平均往返时间”**。

* 在数据链路层点对点的往返时间比较确定，重传时间比较好设定。

* 然而在运输层，由于端到端往返时间非常不确定，设置合适的重传时间有时并不容易。

![3_19](C:\Users\25394\Desktop\md\计算机网络\picture\3_19.png)



**ACK 丢失**

发送方会超时重传，但接收方该怎么知道这是个重复分组还是个新分组呢？

![3_20](C:\Users\25394\Desktop\md\计算机网络\picture\3_20.png)

为了让接收方能够判断所收到的数据分组是否是重复的，需要给**数据分组编号**。

对于停止-等待协议，由于每发送一个数据分组就停止等待，只要保证每发送一个新的数据分组，其发送序号与上次发送的数据分组的序号不同就可以了，因此用**一个比特**来编号就够了。

这样接收方就能知道目前接收到的是重复的分组，直接丢弃并且重新返回一个 ACK。

![3_21](C:\Users\25394\Desktop\md\计算机网络\picture\3_21.png)



那么，确认分组需要编号吗？来看下面这个情况。

**ACK 迟到**

如图，接收方成功接收到了数据 `DATA 0`，也发送了 ACK，但由于种种原因 ACK 迟到了，此时的发送端已经发生了超时重传，有一份新的 `DATA 0` 已经在路上了，此时接收到 ACK 的发送端继续发送 `DATA 1`，那此时第二份 `DATA 0` 的 ACK 返回给发送端时，发送端就无法分辨这究竟是 `DATA 0` 的 ACK 还是 `DATA 1` 的 ACK。

![3_22](C:\Users\25394\Desktop\md\计算机网络\picture\3_22.png)

所以，为了让发送方能够判断所收到的 ACK 分组是否是重复的，需要给 **ACK 分组编号**，所用比特数量与数据分组编号所用比特数量一样。

![3_23](C:\Users\25394\Desktop\md\计算机网络\picture\3_23.png)

需要说明的是，对于数据链路层的点对点信道，重返时间比较固定，不会出现确认迟到的情况。因此，如果只在数据链路层实现停止-等待协议，可以不用给确认分组编号。



#### 信道利用率

$T_D$：发送分组的发送时延。

$RTT$：往返时间。注意此处的 $RTT$ 并不包括发送时延。

$T_A$：确认分组的发送时延（因为很短一般会忽略不计）。

![3_24](C:\Users\25394\Desktop\md\计算机网络\picture\3_24.png)

下面是计算信道利用率的一个例子。

![3_25](C:\Users\25394\Desktop\md\计算机网络\picture\3_25.png)

因此可见：

* 当往返时延 $RTT$ 远大于数据帧发送时延 $T_D$ 时(例如使用卫星链路)，信道利用率非常低。
* 若出现重传，则对于传送有用的数据信息来说，信道利用率还要降低。
* 为了克服停止-等待协议信道利用率很低的缺点，就产生了另外两种协议，即回退 N 帧协议 GBN 和选择重传协议 SR。



顺便提一下，停止等待协议这种通过确认和重传机制实现的可靠传输协议，常称为自动请求重传协议 ARQ（Automatic Repeat reQuest），意思是重传的请求是自动进行的。因为不需要接收方显式地请求发送方重传某个出错的分组。



### 回退 N 帧协议 GBN

停止-等待信道利用率太低，因此考虑连续发送一堆数据来提高利用率，这就是**回退 N 帧协议**（Go-Back-N ARQ，简称 GBN）的基本思想。

![3_26](C:\Users\25394\Desktop\md\计算机网络\picture\3_26.png)



回退 N 帧协议有一个发送窗口和一个接收窗口，只有落在窗口内的分组允许被发送/接收。

发送窗口尺寸 $W_T$ 的取值范围是 $1 < W_T \leq 2^n - 1$ 。其中，n 是构成分组序号的比特数量。
$$
\begin{aligned}
  W_T = 1  &\quad \text{等价于停止-等待协议} \\
  W_T > 2^n - 1  &\quad \text{接收方无法分辨新、旧数据分组}
\end{aligned}
$$
接收方的接收窗口尺寸W的取值范围是 $W_R = 1$ 。因此接收方只能按序接收数据分组。



#### 协议流程

![3_27](C:\Users\25394\Desktop\md\计算机网络\picture\3_27.png)

（无误码情况）

1. 发送方可在未收到接收方确认分组的情况下，将序号落在发送窗口内的多个数据分组全部发送出去。
2. 接收方只接收序号落在接收窗口内且无误码的数据分组，并且将接收窗口向前滑动一个位置，与此同时给发送方发回相应的确认分组。
3. 接收方收到未按序到达的数据分组，除丢弃外，还要对最近按序接收的数据分组进行确认，返回该分组的 ACK。
4. 发送方只有收到对已发送数据分组的确认时，发送窗口才能向前相应滑动。
5. 发送方发送窗口内**某个已发送的数据分组产生超时重发**时，**其后续**在发送窗口内且己发送的数据分组也**必须全部重传**，这就是**回退 N 帧**协议名称的由来。

对于第二步，为了减少开销，接收方不一定每收到一个按序到达且无误码的数据分组就给发送方发回一个确认分组。而是可以在连续收到好几个按序到达且无误码的数据分组后(由具体实现决定)，才针对最后一个数据分组发送确认分组，这称为**累积确认**。或者可以在自己有数据分组要发送时才对之前按序接收且无误码的数据分组进行捎带确认。



#### 差错情况与解决

**发送消息出现误码/丢失**

如图，发送分组 5,6,7,0,1 依次发送，但此时 CRC 检测出分组 5 出现误码，便直接丢弃，同时返回 ACK 4。后续到来的 6,7,0,1 因为和接收窗口要接收的序号对不上，因此也全部被丢弃，同时每个都返回一个 ACK 4 。等到发送方的分组 5 超时重发时，会把发送窗口内 5 和它往后的分组(即 5,6,7,0,1)一起全部重发。另外，当发送方收到多个重复确认时（说明后面的数据都被丢弃了，才连续返回同一个 ACK），可在重传计时器超时前尽早开始重传，由具体实现决定。

![3_29](C:\Users\25394\Desktop\md\计算机网络\picture\3_29.png)

由上例可见，当通信线路质量不好时，回退 N 帧协议的信道利用率并不比停止-等待协议高。



**如果设置的 $W_T$ 超过范围取值**

例如上例取 $W_T$ = 8，会有什么问题？

来看实例：

此时发送方发送完了 0~7 的数据，接收方成功接收，但 ACK 分组丢失，发送方超时重传，重传的分组编号依旧是 0~7，但对接收方来说，要接收的新数据编号也是 0~7，接收方就无法分辨此时到来的是新分组还是重发的旧分组。因此 $W_R$ 必须 $\leq$ $2^n-1$，才能保证新旧分组中不会出现相同的序号。。

![3_28](C:\Users\25394\Desktop\md\计算机网络\picture\3_28.png)





**顺带一提**

* 回退 N 帧协议在流水线传输的基础上利用发送窗回来限制发送疗连续发送数据分组的数量，是一种连续 ARQ 协议。
* 在协议的工作过程中发送窗回和接收窗回不断向前滑动，因此这类协议又称为滑动窗口协议。
* 由于回退 N 帧协议的特性，当通信线路质量不好时，其信道利用率并不比停止-等待协议高。



### 选择重传协议 SR

**回退 N 帧协议**的接收窗口尺寸 **$W_R$ 只能等于 1**，因此**接收方只能按序接收正确到达的数据分组**。

一个数据分组的误码就会导致其后续多个数据分组不能被接收方按序接收而丢弃(尽管它们无乱序和误码)。这必然会造成发送方对这些数据分组的超时重传，显然这是对通信资源的极大浪费。

为了进一步提高性能，可设法只重传出现误码的数据分组。因此，接收窗口的尺寸 **$W_R$ 不应再等于 1 (而应大于 1)**，以便**接收方先收下失序到达但无误码并且序号落在接收窗口内的那些数据分组**，等到所缺分组收齐后再一并送交上层。这就是**选择重传协议**。

**注意:**
**选择重传协议**为了使发送方仅重传出现差错的分组，接收方**不能再采用累积确认**，而需要对每个正确接收到的数据分组进行**逐一确认**！



与回退 N 帧协议相同，选择重传协议有一个发送窗口和一个接收窗口，只有落在窗口内的分组允许被发送/接收。

发送窗口尺寸 $W_T$ 的取值范围是 $1 < W_T \leq 2^{n-1}$ 。其中，n 是构成分组序号的比特数量。
$$
\begin{aligned}
  W_T = 1  &\quad \text{等价于停止-等待协议} \\
  W_T > 2^{n - 1}  &\quad \text{接收方无法分辨新、旧数据分组}
\end{aligned}
$$
接收窗口尺寸 $W_R$ 必须满足：$1 < W_R \leq W_T$
$$
\begin{aligned}
  W_R = 1  &\quad \text{等价于回退 N 帧协议} \\
  W_R > W_T  &\quad \text{无意义}
\end{aligned}
$$



#### 协议流程

![image-20241225160909694](C:\Users\25394\AppData\Roaming\Typora\typora-user-images\image-20241225160909694.png)

1. 发送方可在未收到接收方确认分组的情况下，将序号落在发送窗口内的多个数据分组全部发送出去。
2. 接收方可接收未按序到达但没有误码并且序号落在接收窗口内的数据分组，并对每个正确接收到的数据分组进行逐一确认（ACK）。
3. 接收方只有在按序接收数据分组后，接收窗口才能向前相应滑动一格或多格。
4. 发送方只有按序收到对已发送数据分组的确认时，发送窗口才能向前相应滑动一格或多格；若收到未按序到达的确认分组时，对其进行记录，以防止其相应数据分组的超时重发，但发送窗口不能向前滑动（之后窗口头部滑到这个分组了就会直接滑过）。



#### 差错情况与解决

**发送消息出现误码/丢失**

如图，发送方发送了 0,1,2,3 分组，但 2 号分组丢失。

![3_30](C:\Users\25394\Desktop\md\计算机网络\picture\3_30.png)

接收方接收 0,1 分组，接收窗口向前滑动两格，之后接收 3 分组，给 3 分组打上标记（为了不重复接收）但不滑动窗口。接收方返回 ACK 0,1,3。（此时接收方可择机将已按序接受的 0,1 分组交付上层处理）

![3_31](C:\Users\25394\Desktop\md\计算机网络\picture\3_31.png)

接收方接收到 ACK 0,1，发送窗口向前滑动两格，并将新落入窗口的 4,5 分组发送出去，将已经出窗口的 0,1 分组从发送缓存中删除。接收方接收到 ACK 3，但窗口不能向前滑动，因为这是一个未按序到达的确认分组，因此只记录 3 号分组已确认，这样 3 号分组就不会超时重传。

之后接收方收到 4,5 分组，标记但接收窗口不滑动，返回 ACK 4,5；发送方接收到 ACK 4,5，发送窗口一样不滑动。

再之后 2 号分组超时重传，接收方收到 2 分组，接收窗口头部滑动到 6，返回 ACK 2，发送方接收到 ACK 2，发生窗口头部滑动到 6，发送 6,7,0,1 分组，以此类推。



**如果设置的 $W_T$ 超过范围取值**

首先需要注意一下，回退 N 帧中，$W_T \leq (2^n)-1$，选择重传中 $W_T \leq 2^{(n-1)}$，两者并不一样。为什么范围不一样看了下面就应该能理解了，因为除了发送窗口，还需要给接收窗口留空间。

例如上例取 $W_T=5, W_R =5$，会有什么问题？

来看实例：

此时发送方发送完了 0~4 的数据，接收方成功接收，但 ACK 0 丢失，发送方超时重传，重传 0 分组，但接收方的接收窗口中也包含 0 分组，此时就无法分辨到来的 0 分组究竟是新分组还是重发的旧分组。因此 $W_R$ 必须 $\leq$ $2^{n-1}$，才能保证新旧分组中不会出现相同的序号。

![3_32](C:\Users\25394\Desktop\md\计算机网络\picture\3_32.png)



## *PPP 协议*

### 概述

点对点协议 PPP(Point-to-Point Protocol) 是目前使用最广泛的点对点数据链路层协议。

用户计算机与 ISP 进行通信时，所使用的数据链路层协议通常就是 PPP 协议。在 1999 年公布的在以太网上运行的 PPP 协议，即 PPP over Ethernet，简称为 PPPoE，它使得 ISP 可以通过 DSL、电路调制解调器、以太网等宽带接入技术，以以太网接口的形武为用户提供接入服务。另外，点对点协议 PPP 也广泛应用于广域网路由器之间的专用线路。



![3_33](C:\Users\25394\Desktop\md\计算机网络\picture\3_33.png)



PPP 协议为在点对点链路传输各种协议数据报提供了一个标准方法，主要由以下三部分构成：

* 对各种协议数据报的封装方法(封装成帧)
* 链路控制协议 LCP		用于建立、配置以及测试数据链路的连接
* 一套网络控制协议 NCPs	其中的每一个协议支持不同的网络层协议

PPP 协议能够在多种类型的点对点链路上运行，例如，面向字节的异步链路，面向比特的同步链路。

![3_34](C:\Users\25394\Desktop\md\计算机网络\picture\3_34.png)



### 帧格式

![3_35](C:\Users\25394\Desktop\md\计算机网络\picture\3_35.png)



### 透明传输

![3_36](C:\Users\25394\Desktop\md\计算机网络\picture\3_36.png)

![3_37](C:\Users\25394\Desktop\md\计算机网络\picture\3_37.png)



### 差错检测

![3_38](C:\Users\25394\Desktop\md\计算机网络\picture\3_38.png)



### 工作状态

![3_39](C:\Users\25394\Desktop\md\计算机网络\picture\3_39.png)



## 媒体介入控制

### 基本概念

共享信道要着重考虑的一个问题就是如何协调X多个发送和接收站点对一个共享传输媒体的占用，即**媒体接入控制 MAC **(Medium Access Control)。

![3_40](C:\Users\25394\Desktop\md\计算机网络\picture\3_40.png)

**媒体介入控制**分为：

* **静态划分信道**：预先固定分配好信道，这类方法非常不灵活，对于突发性数据传输信道利用率会很低。通常在无线网络的物理层中使用，而不是在数据链路层中使用。
  * **频分多址**
  * **时分多址**
  * **码分多址**
* **动态接入控制**
  * **受控接入**（现已被淘汰）
    * **集中控制**：有一个主站以循环方式轮询每个站点有无数据发送，只有被轮询到的站点才能发送数据。最大缺点是存在单点故障问题。
    * **分散控制**：各站点是平等的，并连接成一个环形网络。令牌(一个特殊的控制帧)沿环逐站传递，接收到令牌的站点才有权发送数据，并在发送完数据后将令牌传递给下一个站点。
  * **随机接入**：所有站点通过竞争随机地在信道上发送数据。如果恰巧有两个或更多的站点在同一时刻发送数据，则信导在共享媒体上就要产生碰撞(即发生了冲突)。使得这些站点的发送都失败。因此，这类协议要解决的关键问题是如何尽量避免冲突在发生冲突后如何尽快恢复通信。著名的共享式以太网采用的就是随机接入。



随着技术的发展，交换技术的成熟和成本的降低，具有更高性能的使用点对点链路和链路层交换机的交换式局域网在有线领域已完全取代了共享式局域网，但由于无线信道的广播天性，无线局域网仍然使用的是共享媒体技术。



### 静态划分信道

下介绍**信道复用**：

**复用**（Multiplexing）是通信技术中的一个重要概念。复用就是通过一条物理线路同时传输多路用户的信号。

当网络中传输媒体的传输容量大于多条单一信道传输的总通信量时，可利用复用技术在一条物理线路上建立多条通信信道来充分利用传输媒体的带宽。

![3_41](C:\Users\25394\Desktop\md\计算机网络\picture\3_41.png)



#### 频分复用 FDM

将可用频谱分为多个频带，每个频带分配给一个信号传输。每个信号同时以不同频率传输。

![3_42](C:\Users\25394\Desktop\md\计算机网络\picture\3_42.png)



#### 时分复用 TDM

将时间划分为多个时隙，每个信号占用一个固定时隙传输。所有信号按时序顺序发送。

![3_43](C:\Users\25394\Desktop\md\计算机网络\picture\3_43.png)



#### 波分复用 WDM

波分复用其实就是光的频分复用。在光纤通信中，通过将不同的光波长分配给不同的信号传输，实现多信号的同时传输。

![img](file:///D:\qqdata\253944741\nt_qq\nt_data\Pic\2025-01\Ori\186dd59a26e40adb24ee783649e7e258.png)



#### 码分复用 CDM

使用不同的编码（如伪随机码）将多个信号在同一时间、同一频率上传输，通过不同的码进行区分。



##### 一些概念和背景

码分复用 CDM 是另一种共享信道的方法。实际上，由于该技术主要用于多址接入，人们更常用的名词是码分多址 CDMA (Code Division Multiple Access)。

同理，频分复用 FDM 和时分复用 TDM 同样可用于多址接入，相应的名词是频分多址 FDMA (Frequency Division Multiple Access) 和时分多址 TDMA (Time Division Multiple Access)。

在本课程中，我们不严格区分复用与多址的概念，可简单理解如下:

* **复用**是将单一媒体的频带资源划分成很多子信道，这些子信道之间相互独立，互不干扰。从媒体的整体频带资源上看，每个子信道只占用该媒体频带资源的一部分。
* **多址**（更确切地应该称为多点接入）处理的是动态分配信道给用户。这在用户仅仅暂时性地占用信道的应用中是必须的，而所有的移动通信系统基本上都属于这种情况。相反，在信道永久性地分配给用户的应用中，多址是不需要的（对于无线广播或电视广播站就是这样）。
* 某种程度上，FDMA、TDMA、CDMA 可以分别看成是 FDM、TDM、CDM 的应用

CDM 最初是用于军事通信的，因为这种系统所发送的信号有很强的抗干扰能力，其频谱类似于白噪声，不易被敌人发现。随着技术的进步，CDMA 设备的价格和体积都大幅度下降，因而现在已广泛用于民用的移动通信中。



##### 正式介绍

与 FDM 和 TDM 不同，CDM 的每一个用户可以**在同样的时间使用同样的频带进行通信**。由于**各用户使用经过特殊挑选的不同码型**，因此各用户之间**不会造成干扰**。

CDMA 中，每一个比特时间再划分为 m 个短的间隔，称为**码片** (Chip)。通常 m 的值是 64 或 128 。为了简单起见，在后续的举例中，我们假设 m 为 8 。

使用 CDMA 的每一个站被指派一个唯一的 **m bit 码片序列** (Chip Sequence)。

* 一个站如果要发送比特 1，则发送它自己的 m bit **码片序列**；
* 一个站如果要发送比特 0，则发送它自己的 m bit **码片序列的二进制反码**；

【举例】

* 指派给 CDMA 系统中某个站点的码片序列为     00011011
* 发送比特 1：发送自己的码片序列             00011011
* 发送比特 0：发送自己的码片序列的二进制反码  11100100
* 为了方便，我们按惯例将码片序列中的 0 写为 -1，将 1 写为 +1。则该站点的码片序列是 (-1 -1 -1 +1 +1 -1 +1 +1)。

码片序列的挑选原则如下:

1. 分配给每个站的**码片序列必须各不相同**，实际常采用伪随机码序列。
2. 分配给每个站的**码片序列必须相互正交**（规格化内积为0）。

令向量 S 表示站 S 的码片序列，令向量 T 表示其他任何站的码片序列。

两个不同站 S 和 T 的码片序列正交，就是向量 S 和 T 的规格化内积为 0（0 换成 -1 之后向量点乘除序列长度）：
$$
S \cdot T \equiv 0 \qquad S \cdot \overline{T} \equiv 0 \\
S \cdot S \equiv 1 \qquad S \cdot \overline{S} \equiv -1 \\
$$

这样，我们只需要拿这个站点的码片序列乘一下接收到的复合信息，就能知道该站点在此时刻有无发送数据，发送的是 0 还是 1 。

![3_47](C:\Users\25394\Desktop\md\计算机网络\picture\3_47.png)



##### 习题

![3_45](C:\Users\25394\Desktop\md\计算机网络\picture\3_45.png)

![3_46](C:\Users\25394\Desktop\md\计算机网络\picture\3_46.png)













